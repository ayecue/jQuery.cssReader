var cssReader=function(e){var t={targetUrl:"",plainCss:"",fetchedCss:""};cssReader.extend(this,{d:$.extend(t,e),patternFilter:{},patternClasses:/[^{}]+(?={)/g,patternProperties:/[^{}]+(?=})/g,patternProperty:/\w+/,classIns:{container:{keys:[]},add:function(e,t,n,r,i){if(!(t in this.container)){this.container[t]=[];this.container.keys.push(t)}this.container[t].push({priority:e.getPriority(),name:e,path:n,properties:typeof r=="number"?r:false});i.add(e,t)}},refIns:{container:{keys:[]},add:function(e,t){if(!(e in this.container)){this.container[e]=[];this.container.keys.push(e)}this.container[e].push(t)}},compiledIns:{container:{keys:[]},get:function(e,t,n){if(!(e in t.container))return false;if(!(e in this.container)){var r=t.container[e];this.container[e]={keys:[]};this.container.keys.push(e);for(g=0,gl=r.length;g<gl;g++){var i=n.container[r[g].properties].keys,s=i.length;while(--s>=0){var o=n.container[r[g].properties][i[s]],u=o.isImportant();if(!(i[s]in this.container[e])){this.container[e].keys.push(i[s]);this.container[e][i[s]]={priority:r[g].priority,value:o,path:r[g].path,name:r[g].name,important:u}}else if(this.container[e][i[s]].important<u||this.container[e][i[s]].priority<=r[g].priority&&this.container[e][i[s]].important==u){this.container[e][i[s]].priority=r[g].priority;this.container[e][i[s]].value=o;this.container[e][i[s]].path=r[g].path;this.container[e][i[s]].name=r[g].name;this.container[e][i[s]].important=u}}}return this.container[e]}else return this.container[e]}},attrIns:{container:[],add:function(e,t,n){if(!(e in this.container))this.container[e]={keys:[]};if(typeof this.container[e][t]=="function")t="db_"+t;if(!(t in this.container[e])){this.container[e][t]=[];this.container[e].keys.push(t)}this.container[e][t].push(n)}},setUrl:function(e){this.d.targetUrl=e},setCss:function(e,t){this.d.plainCss=e.compressCss();if(t)this.filterCss(t)},filterCss:function(e){var t=typeof e!="string"?t=e.join("|"):e;if(!(t in this.patternFilter))this.patternFilter[t]=new RegExp("[^{}]+{[^{}]*(?:"+t+")[^{}]*}","gi");this.d.plainCss=this.d.plainCss.match(this.patternFilter[t]).join("")},get:function(e){var t=this;if(this.d.targetUrl){return $.ajax({url:this.d.targetUrl,success:function(n){t.setCss(n,e?e:null)}})}},read:function(e){var t=e?e:this.d.plainCss,n,r;while((n=this.patternClasses.exec(t))&&(r=this.patternProperties.exec(t))){var i=r[0].split(";"),s=this.attrIns.container.length,o=i.length;while(--o>=0){var u=i[o];if(this.patternProperty.test(u)){var a=u.split(":"),f=a[0].trimBoth(),l=a[1].trimBoth();if(f.length>0&&l.length>0)this.attrIns.add(s,f,l)}}var c=n[0].split(","),h=c.length;while(--h>=0){var p=c[h];if(p.length>0){var d=p.trimBoth(),v=$(d),m=v?v.getPath():false;if(m===false)this.classIns.add(d,d.getStringHash(),false,s,this.refIns);else{if(v.length>1){var g=v.length;while(--g>=0)this.classIns.add(d,m[g].getStringHash(),m[g],s,this.refIns)}else this.classIns.add(d,m.getStringHash(),m,s,this.refIns)}}}}return true},search:function(e,t){var n=this.refIns.container.keys.length;while(--n>=0){var r=this.refIns.container[this.refIns.container.keys[n]].length;while(--r>=0){var i=this.compiledIns.get(this.refIns.container[this.refIns.container.keys[n]][r],this.classIns,this.attrIns);if(t?t in i:true)e.call(this,i);else if("db_"+t in i)e.call(this,i)}}},scrape:function(e,t){var n=this;$.when(t?n.get(t):n.get()).done(function(){$.when(n.read()).done(function(){if(e)e.call(n,n.d)})})}})};cssReader.extend=function(e,t){for(func in t)e[func]=t[func]};cssReader.extend(cssReader,{debugPrefixFilter:function(e){return e.replace(/^db_/,"")},DOMIndex:0,getIndex:function(e){if(!("DOMIndex"in e))return e.DOMIndex=this.DOMIndex++;return e.DOMIndex},nodeIndexOf:function(t){if("childNodesIndex"in t)return t.childNodesIndex;if(e=t.previousSibling){var n=0;while(e){if("childNodesIndex"in e)return t.childNodesIndex=e.childNodesIndex+1;n++;e=e.previousSibling}return t.childNodesIndex=n}return-1},getSelectors:function(e){if("selectors"in e)return e.selectors;if(x=e.tagName)return e.selectors=x.toLowerCase()+((i=e.id).length>0?"#"+i:"")+((c=e.className).length>0?"."+c.replace(/\s+/g,"."):"");return false},getPathEx:function(e){if(!("pathStack"in e)){var t=e,n=[];while(this.getSelectors(t)){this.nodeIndexOf(t);n.push(t);t=t.parentNode;if("pathStack"in t)return e.pathStack=n.concat(t.pathStack)}return e.pathStack=n}return e.pathStack}});cssReader.extend(String.prototype,{getPriority:function(){var e=(matches=this.match(/#[^\s\.#]+/g))?matches.length*100:0;e+=(matches=this.match(/\.[^\s\.#]+/g))?matches.length*10:0;e+=(matches=this.replace(/[#\.][^\s\.#]+/g,"").match(/[^\s]+(?=#|\.)?/g))?matches.length*1:0;return e},isImportant:function(){return/!important$/gi.test(this)},trimBoth:function(){return this.replace(/^\s+|\s+$/g,"")},compressCss:function(){return this.replace(/\/\*[\s\S]+?\*\/|[^\S][\s\n\r]*[^\S]|[^{}]+{[^\S{}]*?}/g,"")},getStringHash:function(){if((i=this.length)==0)return false;var e=0;while(--i>=0){e=(e<<5)-e+this.charCodeAt(i);e=e&e}return"d:"+e.toString()}});cssReader.extend(Array.prototype,{isImportant:function(){var e=this.length;while(--e>=0)if(this[e].isImportant())return true;return false},getStringHash:function(){if(this.length==0)return false;return"e:"+cssReader.getIndex(this[0])}});jQuery.fn.getPath=function(){if((vl=this.length)>1){var e=[];for(var t=0;t<vl;t++)e.push(cssReader.getPathEx(this[t]));return e}return this.length>0?cssReader.getPathEx(this[0]):false}